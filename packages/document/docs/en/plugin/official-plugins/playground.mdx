# @rspress/plugin-playground

> [Source Code](https://github.com/web-infra-dev/rspress/tree/main/packages/plugin-playground)

Used to preview components in the code block of md(x) files, and provide a real-time playground.

## Installation

```bash
# npm
npm install @rspress/plugin-playground -D
# yarn
yarn add @rspress/plugin-playground -D
# pnpm
pnpm install @rspress/plugin-playground -D
```

## Usage

### Register

First, write the following config in the config file:

```ts title="rspress.config.ts"
import { defineConfig } from 'rspress/config';
import { pluginPlayground } from '@rspress/plugin-playground';

export default defineConfig({
  plugins: [pluginPlayground()],
});
```

:::warning Note

1. After adding this plugin, please do not enable the `markdown.experimentalMdxRs` config, otherwise it will cause the plugin to fail.
2. Please do not use this plugin with the preview plugin at the same time.

:::

### Internal Components

The component code of internal components is declared in the mdx file. This plugin supports jsx and tsx. You can declare the following code block in the mdx file:
````md
```tsx
import React from 'react';

function App() {
  return <div>Hello World</div>;
}

export default App;
```
````

Otherwise, You can use `direction` parameter to specify the playground layout, `horizontal` and `vertical` are supported:

````md
```jsx direction=vertical
import React from 'react';

function App() {
  return <div>Hello World</div>;
}

export default App;
```
````

It's worth noting that you need to export the component as default, and Rspress will automatically render this component.

But if you want to keep the style of the code block instead of rendering it as a component, you can add the `pure` identifier to specify, the usage is as follows:

````md pure
```tsx pure
import React from 'react';

function App() {
  return <div>Hello World</div>;
}

export default App;
```
````

:::tip Tip
Make sure the document ends with `.mdx`.
:::

In this way, the code block will not be rendered as a component, but will be kept as it is.

### External Components

In addition to writing the component code in the code block of the mdx file, you can also write the component code in an external file, and then import it in the mdx file through the code tag. For example

```md title="example.mdx"
<code src="./Demo.tsx" />
```

```tsx title="Demo.tsx"
import React from 'react';

export default function App() {
  return <div>Hello World</div>;
}
```

Same as internal components, external components also support `direction` attribute:

```md title="example.mdx"
<code src="./Demo.tsx" direction="vertical" />
```

External components also need to export the component as default. Through the src attribute of the code tag, you can specify the path of the external component. This plugin supports both relative paths and alias paths(alias).

For some more complex components, this way of using external components will be more convenient.

## Configuration

This plugin accepts an object parameter, the type is as follows:

```ts
interface PlaygroundOptions {
  render: string;
  include: Array<string | [string, string]>;
}
```

### render

You can customize the render file for rendering Playground. Please note that the file name must be `Playground.(jsx?|tsx?)`
```ts
pluginPlayground({
  render: '/path/to/render/Playground.tsx',
});
```

In the custom playground, you can directly import the original editor and renderer, and import pre-packaged dependencies through `playground-imports`:
```ts
import getImport from 'playground-imports';
import { Render, Editor } from '@rspress/plugin-playground/web';
```

You can refer to the built-in [Playground.tsx](https://github.com/web-infra-dev/rspress/tree/main/packages/plugin-playground/static/global-components/Playground.tsx).

### include
By default, this plugin will automatically scan all import statements in the demos, the packages not used in the demos cannot be used in the playground. If you want to add other packages to the playground, you can use the `include` parameter:

```ts
pluginPlayground({
  include: [
    // Add dayjs package
    'dayjs',
    // Add a package named "my-package", and it actual reference to "/path/to/package/index.js"
    ['my-package', '/path/to/package/index.js'],
  ]
});
```

