# è‡ªå®šä¹‰ä¸»é¢˜

æœ¬æ–‡æ‰€è¦ä»‹ç»çš„æ˜¯å¦‚ä½•å¼€å‘ä¸€å¥—è‡ªå®šä¹‰ä¸»é¢˜ã€‚

## åŸºäºé»˜è®¤ä¸»é¢˜çš„æ‰©å±•

å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½ å¹¶ä¸æƒ³ä»é›¶å¼€å§‹å¼€å‘ä¸€ä¸ªä¸»é¢˜ï¼Œè€Œæ˜¯æƒ³åŸºäºé»˜è®¤ä¸»é¢˜è¿›è¡Œæ‰©å±•ï¼Œè¿™æ—¶å€™å¯ä»¥å‚è€ƒä¸‹é¢çš„æ–¹å¼è¿›è¡Œä¸»é¢˜å¼€å‘ã€‚

:::tip
å¦‚æœä½ æƒ³ä»å¤´å¼€å‘ä¸€å¥—è‡ªå®šä¹‰ä¸»é¢˜ï¼Œå¯ä»¥å‰å¾€[ã€é‡æ–°å¼€å‘è‡ªå®šä¹‰ä¸»é¢˜ã€‘](/ui/custom-theme#é‡æ–°å¼€å‘è‡ªå®šä¹‰ä¸»é¢˜)ã€‚
:::

### 1. åŸºæœ¬ç»“æ„

é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `theme` ç›®å½•ï¼Œç„¶ååœ¨ `theme` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `index.ts` æˆ–è€… `index.tsx` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºå¯¼å‡ºä¸»é¢˜é…ç½®ã€‚

```txt
â””â”€â”€ theme
    â””â”€â”€ index.tsx
```

ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼æ¥ä¹¦å†™ `theme/index.tsx` æ–‡ä»¶:

```tsx title="theme/index.tsx"
import { Layout as BasicLayout } from '@rspress/core/theme-original';

const Layout = () => <BasicLayout beforeNavTitle={<div>some content</div>} />;

export { Layout };

export * from '@rspress/core/theme-original';
```

ä¸€æ–¹é¢ä½ éœ€è¦é€šè¿‡ `export` å¯¼å‡ºä¸€ä¸ªä¸»é¢˜é…ç½®å¯¹è±¡ï¼Œå¦ä¸€æ–¹é¢ä½ éœ€è¦é€šè¿‡ `export * from '@rspress/core/theme-original'` å¯¼å‡ºæ‰€æœ‰å…·åå¯¼å‡ºçš„å†…å®¹ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ä½ çš„ä¸»é¢˜é…ç½®èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚

### 2. ä½¿ç”¨æ’æ§½

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ`Layout` ç»„ä»¶è®¾è®¡äº†ä¸€ç³»åˆ—çš„ props æ”¯æŒæ’æ§½å…ƒç´ ï¼Œä½ å¯ä»¥é€šè¿‡è¿™äº› props æ¥æ‰©å±•é»˜è®¤ä¸»é¢˜çš„å¸ƒå±€ï¼Œæ¯”å¦‚å°†ä¸Šé¢çš„ `Layout` ç»„ä»¶æ”¹æˆå¦‚ä¸‹çš„å½¢å¼:

```tsx title="theme/index.tsx"
import { Layout as BasicLayout } from '@rspress/core/theme-original';

// ä»¥ä¸‹å±•ç¤ºæ‰€æœ‰çš„ Props
const Layout = () => (
  <BasicLayout
    /* Home é¡µ Hero éƒ¨åˆ†ä¹‹å‰ */
    beforeHero={<div>beforeHero</div>}
    /* Home é¡µ Hero éƒ¨åˆ†ä¹‹å */
    afterHero={<div>afterHero</div>}
    /* Home é¡µ Features éƒ¨åˆ†ä¹‹å‰ */
    beforeFeatures={<div>beforeFeatures</div>}
    /* Home é¡µ Features éƒ¨åˆ†ä¹‹å */
    afterFeatures={<div>afterFeatures</div>}
    /* æ­£æ–‡é¡µ Footer éƒ¨åˆ†ä¹‹å‰ */
    beforeDocFooter={<div>beforeDocFooter</div>}
    /* æ­£æ–‡é¡µ Footer éƒ¨åˆ†ä¹‹å */
    afterDocFooter={<div>afterDocFooter</div>}
    /* æ­£æ–‡é¡µæœ€å‰é¢ */
    beforeDoc={<div>beforeDoc</div>}
    /* æ­£æ–‡é¡µæœ€åé¢ */
    afterDoc={<div>afterDoc</div>}
    /* æ–‡æ¡£å†…å®¹å‰é¢ */
    beforeDocContent={<div>beforeDocContent</div>}
    /* æ–‡æ¡£å†…å®¹åé¢ */
    afterDocContent={<div>afterDocContent</div>}
    /* å¯¼èˆªæ ä¹‹å‰ */
    beforeNav={<div>beforeNav</div>}
    /* å·¦ä¸Šè§’å¯¼èˆªæ æ ‡é¢˜ä¹‹å‰ */
    beforeNavTitle={<span>ğŸ˜„</span>}
    /* å¯¼èˆªæ æ ‡é¢˜ */
    navTitle={<div>Custom Nav Title</div>}
    /* å·¦ä¸Šè§’å¯¼èˆªæ æ ‡é¢˜ä¹‹å */
    afterNavTitle={<div>afterNavTitle</div>}
    /* å¯¼èˆªæ å³ä¸Šè§’éƒ¨åˆ† */
    afterNavMenu={<div>afterNavMenu</div>}
    /* å·¦ä¾§ä¾§è¾¹æ ä¸Šé¢ */
    beforeSidebar={<div>beforeSidebar</div>}
    /* å·¦ä¾§ä¾§è¾¹æ ä¸‹é¢ */
    afterSidebar={<div>afterSidebar</div>}
    /* å³ä¾§å¤§çº²æ ä¸Šé¢ */
    beforeOutline={<div>beforeOutline</div>}
    /* å³ä¾§å¤§çº²æ ä¸‹é¢ */
    afterOutline={<div>afterOutline</div>}
    /* æ•´ä¸ªé¡µé¢æœ€é¡¶éƒ¨ */
    top={<div>top</div>}
    /* æ•´ä¸ªé¡µé¢æœ€åº•éƒ¨ */
    bottom={<div>bottom</div>}
    /* è‡ªå®šä¹‰ MDX ç»„ä»¶ */
    components={{ p: (props) => <p {...props} className="my-4 leading-7" /> }}
  />
);

export { Layout };
// é‡å¯¼å‡º
export * from '@rspress/core/theme-original';
```

### 3. è‡ªå®šä¹‰ç»„ä»¶

è¦æ‰©å±•é»˜è®¤ä¸»é¢˜çš„ç»„ä»¶ï¼Œé™¤äº†æ’æ§½æ–¹å¼ä»¥å¤–ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰ Home é¡µé¢ç»„ä»¶åŠ 404 é¡µé¢ç»„ä»¶ï¼Œ
ä»¥åŠå…¶ä»– Rspress [å†…ç½®çš„ç»„ä»¶](https://github.com/web-infra-dev/rspress/tree/main/packages/theme-default/src/components)ã€‚æ¯”å¦‚:

```tsx title="theme/index.tsx"
import {
  Search as BasicSearch,
  Layout as BasicLayout,
} from '@rspress/core/theme-original';

// å®šåˆ¶ Home é¡µé¢
const HomeLayout = () => <div>Home</div>;
// å®šåˆ¶ 404 é¡µé¢
const NotFoundLayout = () => <div>404</div>;
// ä¼ å…¥æ’æ§½
const Layout = () => (
  <BasicLayout
    beforeNavTitle={<div>some content</div>}
    HomeLayout={HomeLayout}
    NotFoundLayout={NotFoundLayout}
  />
);

// å®šåˆ¶ Search ç»„ä»¶
const Search = () => (
  <div className="my-search">
    <BasicSearch />
  </div>
);
export { Search, HomeLayout, NotFoundLayout };
// é‡å¯¼å‡ºå…¶ä»–éƒ¨åˆ†
export * from '@rspress/core/theme-original';
```

å½“ç„¶ï¼Œåœ¨å¼€å‘è¿‡ç¨‹å¯èƒ½éœ€è¦ä½¿ç”¨é¡µé¢çš„æ•°æ®ï¼Œä½ å¯ä»¥é€šè¿‡ [`Runtime API`](/api/client-api/api-runtime) æ¥è·å–ã€‚

### 4. è‡ªå®šä¹‰å›¾æ ‡

å¦‚æœæƒ³è¦å•ç‹¬ä¿®æ”¹é»˜è®¤ä¸»é¢˜ç»„ä»¶é‡Œç”¨åˆ°çš„å›¾æ ‡ï¼Œåªéœ€è¦å°†åŒåå›¾æ ‡æ”¾åœ¨ theme/assets ç›®å½•ä¸‹å³å¯ã€‚

```txt
â””â”€â”€ theme
    â””â”€â”€ assets
        â””â”€â”€ logo.svg
```

ä½ å¯ä»¥åœ¨ [è¿™é‡Œ](https://github.com/web-infra-dev/rspress/tree/main/packages/theme-default/src/assets) æŸ¥çœ‹é»˜è®¤ä¸»é¢˜ä¸­ç”¨åˆ°çš„æ‰€æœ‰å›¾æ ‡ã€‚

## é‡æ–°å¼€å‘è‡ªå®šä¹‰ä¸»é¢˜

å¦‚æœä½ è¦ä»å¤´å¼€å§‹å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰ä¸»é¢˜ï¼Œä½ éœ€è¦äº†è§£ä¸€ä¸‹ä¸»é¢˜çš„ç»„æˆã€‚

### 1. åŸºæœ¬ç»“æ„

é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `theme` ç›®å½•ï¼Œç„¶ååœ¨ `theme` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `index.ts` æˆ–è€… `index.tsx` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºå¯¼å‡ºä¸»é¢˜é…ç½®ã€‚

```txt
â”œâ”€â”€ theme
â”‚   â””â”€â”€ index.tsx
```

åœ¨ `theme/index.tsx` æ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦å¯¼å‡ºä¸€ä¸ª Layout ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å°±æ˜¯ä½ çš„ä¸»é¢˜çš„å…¥å£ç»„ä»¶:

```tsx
// theme/index.tsx
import { Layout as BasicLayout } from '@rspress/core/theme-original';

function Layout() {
  return <BasicLayout />;
}

export { Layout };
// å¯¼å‡ºé»˜è®¤ä¸»é¢˜çš„æ‰€æœ‰å†…å®¹ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ä½ çš„ä¸»é¢˜é…ç½®èƒ½å¤Ÿæ­£å¸¸å·¥ä½œ
export * from '@rspress/core/theme-original';
```

### 2. è¿è¡Œæ—¶ API

#### usePageData

è·å–ç«™ç‚¹æ‰€æœ‰æ•°æ®çš„ä¿¡æ¯ï¼Œæ¯”å¦‚:

```tsx
import { usePageData } from '@rspress/core/runtime';

function MyComponent() {
  const pageData = usePageData();
  return <div>{pageData.title}</div>;
}
```

#### useLang

è·å–å½“å‰è¯­è¨€ä¿¡æ¯ï¼Œæ¯”å¦‚:

```tsx
import { useLang } from '@rspress/core/runtime';

function MyComponent() {
  const lang = useLang();
  return <div>{lang}</div>;
}
```

#### Content

æ­£æ–‡ MDX ç»„ä»¶å†…å®¹ï¼Œå¦‚:

```tsx
import { Content } from '@rspress/core/runtime';

function Layout() {
  return (
    <div>
      <Content />
    </div>
  );
}
```

#### è·¯ç”± Hook

Rspress å†…éƒ¨ç”¨ [react-router-dom](https://reactrouter.com/) æ¥å®ç°è·¯ç”±ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ `react-router-dom` çš„ Hookï¼Œæ¯”å¦‚:

```ts
import { useLocation } from '@rspress/core/runtime';

function Layout() {
  const location = useLocation();
  return <div>Current location: {location.pathname}</div>;
}
```

### 3. æœç´¢åŠŸèƒ½å¤ç”¨

é»˜è®¤ä¸»é¢˜å†…ç½®äº†æœç´¢åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœç´¢ç»„ä»¶æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

1. æœç´¢æ¡†ï¼Œå³å”¤èµ·æœç´¢çš„å…¥å£ã€‚
2. ç‚¹å‡»æœç´¢æ¡†åå¼¹å‡ºçš„æœç´¢é¢æ¿ã€‚

#### å®Œæ•´å¤ç”¨

å¦‚æœä½ æƒ³å®Œæ•´å¤ç”¨æœç´¢åŠŸèƒ½ï¼Œä½ å¯ä»¥ç›´æ¥å¼•å…¥ `Search` ç»„ä»¶ï¼Œæ¯”å¦‚:

```tsx
import { Search } from '@rspress/core/theme-original';

function MySearch() {
  return <Search />;
}
```

#### å¤ç”¨æœç´¢é¢æ¿

å¦‚æœä½ ä»…ä»…æƒ³å¤ç”¨æœç´¢é¢æ¿ï¼Œæƒ³è¦è‡ªå®šä¹‰æœç´¢æ¡†éƒ¨åˆ†ï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„ä¸»é¢˜ç»„ä»¶ä¸­å¼•å…¥ `SearchPanel` ç»„ä»¶ï¼Œæ¯”å¦‚:

```tsx
import { useState } from 'react';
import { SearchPanel } from '@rspress/core/theme-original';

function MySearch() {
  const [focused, setFocused] = useState(false);
  return (
    <div>
      <button onClick={() => setFocused(true)}>Toggle Search</button>
      <SearchPanel focused={focused} setFocused={setFocused} />
    </div>
  );
}
```

å…¶ä¸­ï¼Œä½ éœ€è¦è‡ªå·±ç»´æŠ¤ `focused` çŠ¶æ€å’Œ `setFocused` æ–¹æ³•ï¼Œå¹¶ä¸”ä½œä¸º props ä¼ ç»™ `SearchPanel` ç»„ä»¶ï¼Œç”¨äºæ§åˆ¶æœç´¢é¢æ¿çš„æ˜¾ç¤ºå’Œéšè—ã€‚

#### å¤ç”¨é»˜è®¤å…¨æ–‡æœç´¢é€»è¾‘

å¦‚æœä½ æƒ³å¤ç”¨é»˜è®¤çš„å…¨æ–‡æœç´¢é€»è¾‘ï¼Œä½ å¯ä»¥ä½¿ç”¨ `useFullTextSearch` Hookï¼Œæ¯”å¦‚:

```tsx
import { useFullTextSearch } from '@rspress/core/theme-original';

function MySearch() {
  const { initialized, search } = useFullTextSearch();

  useEffect(() => {
    async function searchSomeKeywords(keywords: string) {
      if (initialized) {
        // æœç´¢å…³é”®å­—
        const results = await search(keywords);
        console.log(results);
      }
    }
    searchSomeKeywords('keyword');
  }, [initialized]);

  return <div>Search</div>;
}
```

å…¶ä¸­ï¼Œ`initialized` è¡¨ç¤ºæœç´¢æ˜¯å¦åˆå§‹åŒ–å®Œæˆï¼Œ`search` æ–¹æ³•ç”¨äºæœç´¢å…³é”®å­—ï¼Œè¿”å›ä¸€ä¸ª Promiseï¼ŒPromise çš„ç»“æœä¸ºé»˜è®¤å…¨æ–‡æœç´¢çš„ç»“æœã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`useFullTextSearch` Hook ä¼šåœ¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨åŠ è½½æœç´¢ç´¢å¼•ï¼Œæ‰€ä»¥ä½ éœ€è¦å…ˆåˆ¤æ–­ `initialized` çŠ¶æ€ï¼Œç¡®ä¿åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œç„¶åå†è°ƒç”¨ `search` æ–¹æ³•ã€‚

search æ–¹æ³•çš„ç±»å‹å®šä¹‰å¦‚ä¸‹:

```ts
type SearchFn = (keywords: string, limit?: number) => Promise<SearchResult>;
```

limit è¡¨ç¤ºæœç´¢ç»“æœçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º 7ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤æœ€å¤šè¿”å›ä¸ƒç¯‡æ–‡ç« çš„ç»“æœã€‚
