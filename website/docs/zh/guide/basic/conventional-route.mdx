# 约定式路由

## 什么是约定式路由

Rspress 使用的是文件系统路由，页面的文件路径会简单地映射为路由路径，这样会让整个项目的路由非常直观。

例如，如果在 `docs` 目录中有一个名为 `foo.md` 的文件，则该文件的路由路径将是 `/foo`。

## 映射规则

Rspress 会自动扫描根目录和所有子目录，并将文件路径映射到路由路径。例如，如果你有以下的文件结构：

```tree
docs
├── foo
│   ├── bar.md
│   └── index.md
├── foo.md
├── zoo
│   └── index.md
└── index.md
```

那么 `bar.md` 的路由路径会是 `/foo/bar`，`foo.md` 的路由路径会是 `/foo`， `/foo/index.md` 的路由路径会是 `/foo/`。

具体映射规则如下：

| 文件路径        | 路由路径   | `cleanUrl: false` 路径 |
| --------------- | ---------- | ---------------------- |
| `index.md`      | `/`        | `/index.html`          |
| `/foo.md`       | `/foo`     | `/foo.html`            |
| `/foo/index.md` | `/foo/`    | `/foo/index.html`      |
| `/foo/bar.md`   | `/foo/bar` | `/foo/bar.html`        |
| `/zoo/index.md` | `/zoo/`    | `/zoo/index.html`      |

## 组件路由

在约定式路由中，除了 `.md(x)` 文件，还可以使用 `.tsx` 文件作为路由组件，在 `.tsx` 中默认导出一个组件，该组件会被自动注册到路由中。例如：

```tsx title="foo.tsx"
export default () => {
  return <div>foo</div>;
};
```

当然，如果你想要定制布局，可以添加一个导出，声明布局类型，例如：

```tsx title="foo.tsx"
export const frontmatter = {
  // 声明布局类型
  // 这里的 custom 布局中不会出现侧边栏
  pageType: 'custom',
};
```

各个 pageType 的含义详情请参考 [API 文档](/api/config/config-frontmatter#pagetype)。

## 自定义行为

如果要自定义路由行为，可以使用配置文件中的 `route` 字段。例如：

```ts title="rspress.config.ts"
import { defineConfig } from '@rspress/core';

export default defineConfig({
  route: {
    // 这些文件会被注册为路由（支持 glob 模式）
    include: ['other-dir/**/*'],
    // 这些文件将不会被注册为路由（支持 glob 模式）
    exclude: ['components/**/*', 'fragments/**/*'], /
  },
});
```

## 最佳实践

我们推荐你将文档文件放在 `docs` 目录下，这样可以让你的项目更加清晰。而对于非文档内容，比如自定义组件、工具函数等，可以放到 `docs` 目录之外进行维护。

:::tip

如果要将 `.tsx` 或者 `.mdx` 文件放在 `docs` 目录，需要配合 `route.excludes` 使用，否则这些文件会被自动注册为路由，可能会导致一些意外的问题。

:::

以下是一种最佳实践，配合 `route.excludes` 使用，可以让你的项目结构更加清晰：

```tree
├── docs
│   ├── components  # 用于放置文档中使用到的 React 组件
│   │   └── Example.tsx
│   ├── fragments   # 用于放置一些文档片段
│   │   └── example.mdx
│   └── index.mdx
└── theme
    ├── components # 用于放置主题相关的 React 组件
    |   └── DocFooter.tsx
    └── index.tsx
```

```ts title="rspress.config.ts"
import { defineConfig } from '@rspress/core';

export default defineConfig({
  route: {
    exclude: ['components/**/*', 'fragments/**/*'], // 这些目录下的文件不会被注册为路由
  },
});
```

```json title="tsconfig.json"
{
  "compilerOptions": {
    "lib": ["DOM", "ESNext"],
    "jsx": "react-jsx",
    "moduleResolution": "bundler",
    "paths": {
      "i18n": ["./i18n.json"],
      "@theme": ["./theme/index.tsx"]
    }
  },
  "include": ["docs", "theme", "rspress.config.ts"],
  "mdx": {
    "checkMdx": true
  }
}
```
